(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1332:function(t,e,o){"use strict";o.r(e);var n=o(6),r=(o(685),o(13)),a=o(3),l=o(7),i=o(9),u=o(42);function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function d(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=w(t);if(e){var r=w(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return b(this,o)}}function b(t,e){return!e||"object"!==typeof e&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}var p=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(b,t);var e,o,n,r=d(b);function b(){var t;c(this,b);for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=r.call.apply(r,[this].concat(o))).removeEventListeners=function(){var e=setInterval((function(){t.followEventFinished&&(t.element.removeEventListener("ajax:success",t.updateFollowStatus),t.element.removeEventListener("ajax:error",t.initiateFollowChange),clearInterval(e))}),100)},t.followAfterLogin=function(){Object(a.K)("follow_after_login",t.element.dataset.userId),Object(l.k)({data:{category:"Trigger-Contributor_Follow",action:i.Ab}}),t.trackContributorFollow({target:t.element})},t.initiateFollowChange=function(){t.selectedContributorId=t.element.dataset.userId,t.contributorsDataElement=document.querySelector("[data-contributors-info]"),t.contributorsDataElement&&document.body.setAttribute("data-updating-follow-status",t.selectedContributorId),document.querySelectorAll('[data-follow-button-target="followButton"][data-user-id="'.concat(t.selectedContributorId,'"]')).forEach((function(t){t.classList.toggle("is-following"),Object(u.b)(t)}))},t.updateFollowStatus=function(){t.contributorsDataElement?(t.updateContributorsInfoElement(),t.updateFollowButtonsWithContributorsInfo()):t.simpleToggleFollowButton()},t.simpleToggleFollowButton=function(){var e=t.element.href,o=t.textWrapTarget.innerHTML;t.textWrapTarget.innerHTML=t.element.dataset.switchText,t.element.dataset.switchText=o,t.element.href=t.element.dataset.switchHref,t.element.dataset.switchHref=e,Object(u.a)(t.element)},t.updateContributorsInfoElement=function(){t.contributorsData=JSON.parse(t.contributorsDataElement.dataset.contributorsInfo),t.element.classList.remove("has-spinner");var e={follow_button_text:t.contributorsData[t.selectedContributorId].follow_button_switch_text,follow_button_switch_text:t.contributorsData[t.selectedContributorId].follow_button_text,follow_button_action:t.contributorsData[t.selectedContributorId].follow_button_switch_action,follow_button_switch_action:t.contributorsData[t.selectedContributorId].follow_button_action,follow_button_class:t.element.className};Object.assign(t.contributorsData[t.selectedContributorId],e),t.contributorsDataElement.dataset.contributorsInfo=JSON.stringify(t.contributorsData),document.body.removeAttribute("data-updating-follow-status")},t.updateFollowButtonsWithContributorsInfo=function(){document.querySelectorAll('[data-follow-button-target="followButton"][data-user-id="'.concat(t.selectedContributorId,'"]')).forEach((function(e){var o=e.querySelector(".ez-spinner--sm");e.classList.remove("has-spinner"),e.querySelector('[data-follow-button-target="textWrap"]').innerHTML=t.contributorsData[t.selectedContributorId].follow_button_text,e.switchText=t.contributorsData[t.selectedContributorId].follow_button_switch_text,e.href=t.contributorsData[t.selectedContributorId].follow_button_action,e.className=t.contributorsData[t.selectedContributorId].follow_button_class,o&&Object(u.a)(e)}))},t.trackContributorFollow=function(t){Object(l.k)({element:t.target,data:{action:i.x,category:"Contributor"}})},t}return e=b,(o=[{key:"connect",value:function(){this.element.dataset.action&&"follow-button#followAfterLogin"!==this.element.dataset.action&&(this.element.addEventListener("ajax:success",this.updateFollowStatus),this.element.addEventListener("ajax:error",this.initiateFollowChange)),this.flagLoaded()}},{key:"disconnect",value:function(){this.removeEventListeners()}},{key:"followEventFinished",get:function(){return!document.body.hasAttribute("data-updating-follow-status")}},{key:"getUsername",value:function(){var t=document.querySelector(".user-profile-layout"),e=document.querySelector(".ez-resource-show__contributor");return(null===t||void 0===t?void 0:t.getAttribute("data-profile-username"))||(null===e||void 0===e?void 0:e.getAttribute("data-contributor-name"))}}])&&s(e.prototype,o),n&&s(e,n),b}(r.a);p.targets=["textWrap","followButton"],n.default.register("follow-button",p)},685:function(t,e,o){}}]);
//# sourceMappingURL=following-e6d3690f5b927828a4ac.chunk.js.map